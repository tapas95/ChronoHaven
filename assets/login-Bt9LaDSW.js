import{c as w,d as m,b as g,s as f,a as s,e as y,f as p,G as h,h as b,i as I}from"./alert-Bbh7v47E.js";/* empty css                       */import{t as v}from"./togglePasswordVisibility-CFsXdpQZ.js";const E=async a=>{try{const e=JSON.parse(localStorage.getItem("guestCart"))||[];if(!e.length)return;const r=w(m,"users",a,"cart");for(const t of e){const o=g(r);await f(o,{productId:t.productId,quantity:t.quantity,variantId:t.variantId||null})}localStorage.removeItem("guestCart")}catch(e){console.error("Failed to sync guest cart to user:",e)}},n=document.getElementById("loginForm"),l=document.getElementById("email"),c=document.getElementById("password"),d=document.getElementById("submitLogin");v("passwordVisibility","password");n.addEventListener("submit",async a=>{a.preventDefault(),document.querySelectorAll(".alert").forEach(t=>t.remove());const e=l.value.trim(),r=c.value.trim();if(!e)return l.insertAdjacentHTML("afterend",s("Please Enter Email Address"));if(!r)return c.parentElement.insertAdjacentHTML("afterend",s("Please Enter Password"));d.disabled=!0;try{const t=await y(p,e,r);n.innerHTML=s("Signed in successfully. Redirecting now.","success"),await E(t.user.uid),setTimeout(()=>{window.location.href="./"},1e3)}catch(t){switch(t.code){case"auth/invalid-credential":n.insertAdjacentHTML("afterbegin",s("Invalid Email or Password","danger","mb-3"));break;case"auth/network-request-failed":n.insertAdjacentHTML("afterbegin",s("Network error: Please check your internet connection and try again.","danger","mb-3"));break}}finally{d.disabled=!1}});const u=document.getElementById("loginWithGoogle"),L=new h;u&&u.addEventListener("click",async()=>{try{const e=(await b(p,L)).user,r=g(m,"users",e.uid);if(!(await I(r)).exists()){const i=(e.displayName||"Guest").split(" ");await f(r,{firstName:i[0],lastName:i[1],email:e.email,phone:e.phoneNumber||null,avatar:e.photoURL,gender:"Other"})}window.location.href="./"}catch(a){console.error("‚ùå Google login failed:",a.code,a.message),alert("Google login failed: "+a.message)}});

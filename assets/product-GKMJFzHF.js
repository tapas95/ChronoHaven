import{c as X,d as J,q as G,w as K,g as Y,a as h,b as Z,j as ee}from"./alert-CXZLJFli.js";import{u as te}from"./header-BBEU-fna.js";import{r as ne,a as oe,b as re,S as M}from"./addToCart-CQJkqlmL.js";const ae=async(t,s,d)=>{ne(d,3);try{const n=X(J,"collections","products","items"),a=G(n,K("category","==",s)),p=await Y(a);if(p.empty){d.insertAdjacentHTML("beforeend",h("No Products Found.","danger"));return}const l=[];p.forEach(e=>{const r=e.data();r.id!==t&&(l.push(r),d.insertAdjacentHTML("beforeend",oe(r)))}),l.length===0&&d.insertAdjacentHTML("beforeend",h("No related products found.","danger","bi-exclamation-diamond-fill","mx-2")),requestAnimationFrame(()=>{const e=document.querySelectorAll(".variant-images"),r=document.querySelectorAll(".product-title"),g=document.querySelectorAll(".add-to-cart");g.forEach(i=>{i.addEventListener("click",u=>{u.preventDefault(),document.querySelectorAll(".alert").forEach(o=>o.remove()),i.disabled=!0,i.insertAdjacentHTML("beforeend",'<div class="spinner-border spinner-border-sm text-light" role="status"><span class="visually-hidden">Loading...</span></div>');const c=i.getAttribute("data-product-id"),m=i.getAttribute("data-variant-id");c&&m?re(c,m,1).then(o=>{o==="ADDED"?(i.parentElement.insertAdjacentHTML("afterend",h("Product Added To Cart","success","bi-check-circle-fill","fs-xs")),te()):o==="EXISTS"&&i.parentElement.insertAdjacentHTML("afterend",h("Product Already Exist","danger","bi-exclamation-diamond-fill","fs-xs"))}).catch(o=>{console.log("Failed to add to cart",o)}).finally(()=>{i.disabled=!1;const o=i.querySelector(".spinner-border");o&&o.remove()}):console.warn("Product or Variant ID missing")})}),e.forEach((i,u)=>{new M(i,{perPage:1,arrows:!1,pagination:!0,drag:!1}).mount();const m=l[u];if(!m||!m.variants)return;const b=i.querySelectorAll(".splide__pagination__page");m.variants.forEach((o,I)=>{const y=b[I];if(!y||!o.colors)return;const q=o.colors.map(E=>o.colors.length>1?`${E} ${100/o.colors.length}%`:E).join(", ");y.style.cssText=`
                        --variant-base-color: ${o.colors[0]};
                        background-image: linear-gradient( -45deg, ${q} );
                        box-shadow: 0 0 0 0.125rem ${o.colors[0]};
                    `,y.setAttribute("data-variant-id",`${o.id}`),y.addEventListener("click",()=>{const E=o.id,C=r[u],B=g[u];if(!C||!B)return;const S=new URL(C.href,window.location.origin);S.searchParams.delete("variantId"),S.searchParams.append("variantId",E),C.href=S.toString(),B.setAttribute("data-variant-id",`${E}`)})})})})}catch(n){console.log(n),d.insertAdjacentHTML("beforeend",h("Error Loading Products.","danger"))}finally{const n=document.getElementById("productCardSkeleton");n&&n.remove()}};let T=null,A=null;const D=(t,s)=>{t!=null&&t.splide&&t.splide.destroy(!0),s!=null&&s.splide&&s.splide.destroy(!0),A=new M(s,{fixedWidth:100,height:100,gap:12,pagination:!1,arrows:!1,isNavigation:!0}),T=new M(t,{pagination:!1,arrows:!1}),T.sync(A),T.mount(),A.mount()},ce=(t,s)=>{var n;const d=document.createElement("ul");return d.classList.add("varients","list-inline","d-flex","align-items-center","gap-3","mt-0"),(n=t.variants)==null||n.forEach(a=>{var l;const p=`
            <li class="mb-0">
                <button class="varient-button d-block rounded-circle transition-3 ${a.id===s?"active":null}" style="--variant-base-color: ${a.colors[0]};background-image: linear-gradient( -135deg, ${(l=a.colors)==null?void 0:l.map(e=>a.colors.length>1?`${e} ${100/a.colors.length}%`:`${e}`).join(", ")} );box-shadow: 0 0 0 0.125rem ${a.colors[0]};" data-varient-id="${a.id}"></button>
            </li>
        `;d.insertAdjacentHTML("beforeend",p)}),d},se=(t,s,d,n=10)=>{const a=n===0?0:1,p=()=>{let e=parseInt(t.value)||1;(isNaN(e)||e<a)&&(e=a),e>n&&(e=n),t.value=e,l(e)},l=e=>{s.disabled=e>=n,d.disabled=e<=a};t.addEventListener("input",()=>t.value=t.value.replace(/[^0-9]/g,"")),t.addEventListener("blur",p),t.addEventListener("change",()=>{let e=parseInt(t.value)||a;l(e)}),s.addEventListener("click",e=>{e.preventDefault();let r=parseInt(t.value)||a;r<n&&r++,t.value=r,l(r)}),d.addEventListener("click",e=>{e.preventDefault();let r=parseInt(t.value)||a;r>a&&r--,t.value=r,l(r)}),p()},H=document.getElementById("productCategory"),j=document.querySelector("#productImageWrapper .splide__list"),N=document.querySelector(".product-variant-slider"),_=document.querySelector(".product-variant-thumbnail-slider"),R=document.querySelector(".product-variant-thumbnail-slider .splide__list"),V=document.getElementById("productName"),F=document.getElementById("productShortDescription"),Q=document.getElementById("productRating"),O=document.getElementById("variantsContainer"),W=document.getElementById("productDetailedDescription"),z=document.getElementById("selectedProductName"),L=document.getElementById("selectedProductImg"),k=document.getElementById("selectedProductColor"),P=document.getElementById("selectedProductQuantity"),f=document.querySelector("#quantity #quantityInput"),w=document.querySelector("#quantity #plus"),x=document.querySelector("#quantity #minus"),v=document.getElementById("stock"),$=document.getElementById("totalPrice"),U=document.getElementById("buyNow"),ie=document.getElementById("relatedProducts"),de=async()=>{var a;const t=new URLSearchParams(window.location.search),s=t.get("id"),d=t.get("variantId");let n=parseInt(f.value)||1;try{const p=Z(J,"collections","products","items",s),l=await ee(p);if(l.exists()){const e=l.data();let r=d;document.title=`Product | ${e.name}`,H&&(H.textContent=e.category),V&&(V.textContent=e.name),F&&(F.textContent=e.shortDescription),Q&&(Q.textContent=`${e.rating} Ratings`),O&&O.append(ce(e,r));const g=document.querySelectorAll(".varient-button"),i=e.variants.find(c=>c.id===r);if(e.variants.length>0&&i.images.length>0){const c=(a=i.images)==null?void 0:a.map(m=>`
                    <li class="splide__slide mb-0">
                        <img src="${m}" alt="${e.name}" class="d-block img-fluid mx-auto" />
                    </li>
                `).join("");j.innerHTML=c,R.innerHTML=c}requestAnimationFrame(()=>D(N,_)),g==null||g.forEach(c=>{c.addEventListener("click",()=>{var b;g.forEach(o=>o.classList.remove("active")),c.classList.add("active");const m=c.getAttribute("data-varient-id");r!==m&&(r=m,(b=e.variants)==null||b.forEach(o=>{var I;if(o.id===m){const y=(I=o.images)==null?void 0:I.map(q=>`<li class="splide__slide mb-0"><img src="${q}" alt="${e.name}" class="d-block img-fluid mx-auto" /></li>`).join("");j.innerHTML=y,R.innerHTML=y,requestAnimationFrame(()=>D(N,_)),L&&(L.innerHTML=`<img src="${o.images[0]}" alt="${e.name}" class="d-block img-fluid mx-auto" /> `),k&&(k.innerHTML=`<span class="current-variant-color d-block rounded-circle" style="background-color: ${o.colors[0]};"></span>`)}}))})}),W&&W.insertAdjacentHTML("beforeend",`
                <p>${e.detailedDescription}</p>
                <ul class="list-inline">
                    ${Object.keys(e.specifications).map(c=>`
                            <li class="d-flex align-items-center gap-2">
                                <span class="d-block">${c}: </span>
                                <span class="d-block fw-semibold">${e.specifications[c]}</span>
                            </li>
                        `).join("")}
                </ul>
            `),e.variants.forEach(c=>{c.id===r&&(L&&(L.innerHTML=`<img src="${c.images[0]}" alt="${e.name}" class="d-block img-fluid mx-auto" /> `),k&&(k.innerHTML=`<span class="current-variant-color d-block rounded-circle" style="background-color: ${c.colors[0]};"></span>`))}),z&&(z.textContent=e.name),P&&(P.textContent=n),se(f,w,x,e.inStock),e.inStock===0&&(f.value=0,f.disabled=!0,w.disabled=!0,x.disabled=!0,v&&(v.textContent="Out of Stock"));const u=()=>{if(n=parseInt(f.value)||0,n>e.inStock&&(n=e.inStock,f.value=n),e.inStock===0){$&&($.textContent="₹ 0.00"),v&&(v.textContent="Out of Stock");return}$&&($.textContent=`₹ ${parseInt(e.price.current)*n}.00`),v&&(v.textContent=e.inStock-n),P&&(P.textContent=n)};u(),f.addEventListener("input",u),f.addEventListener("blur",u),f.addEventListener("change",u),w.addEventListener("click",u),x.addEventListener("click",u),U&&U.addEventListener("click",()=>{sessionStorage.setItem("buyNowItem",JSON.stringify({productId:s,productVariant:r,productQuantity:n})),window.location.href="./checkout.html?buyNow=true"}),ae(e.id,e.category,ie)}else console.log("No such Product Found!")}catch(p){console.log(p)}};de();

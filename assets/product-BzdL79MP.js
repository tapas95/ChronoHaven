import{c as ce,d as re,q as le,w as ue,g as me,a as v,b as ge,e as pe}from"./alert-BfWc_co2.js";import{u as se}from"./header-DJ3fnkyg.js";import{r as fe,a as ve,c as M,b as ae,S as j}from"./checkIsFavorite-C333rjYG.js";import{a as oe}from"./addToCart-DZrD-kkr.js";const he=async(n,d,m)=>{fe(m,3);try{const s=ce(re,"collections","products","items"),c=le(s,ue("category","==",d)),l=await me(c);if(l.empty){m.insertAdjacentHTML("beforeend",v("No Products Found.","danger"));return}const g=[];l.forEach(e=>{const a=e.data();a.id!==n&&(g.push(a),m.insertAdjacentHTML("beforeend",ve(a)))}),g.length===0&&m.insertAdjacentHTML("beforeend",v("No related products found.","danger","bi-exclamation-diamond-fill","mx-2")),requestAnimationFrame(()=>{(async()=>{const e=document.querySelectorAll(".variant-images"),a=document.querySelectorAll(".product-title"),b=document.querySelectorAll(".add-to-cart"),T=document.querySelectorAll(".add-to-favorite");if(b.forEach(t=>{t.addEventListener("click",r=>{r.preventDefault(),document.querySelectorAll(".alert").forEach(i=>i.remove()),t.disabled=!0,t.insertAdjacentHTML("beforeend",'<div class="spinner-border spinner-border-sm text-light" role="status"><span class="visually-hidden">Loading...</span></div>');const o=t.getAttribute("data-product-id"),u=t.getAttribute("data-variant-id");o&&u?oe(o,u,1).then(i=>{i==="ADDED"?(t.parentElement.insertAdjacentHTML("afterend",v("Product Added To Cart","success","bi-check-circle-fill","fs-xs")),se()):i==="EXISTS"&&t.parentElement.insertAdjacentHTML("afterend",v("Product Already Exist","danger","bi-exclamation-diamond-fill","fs-xs"))}).catch(i=>{console.log("Failed to add to cart",i)}).finally(()=>{t.disabled=!1;const i=t.querySelector(".spinner-border");i&&i.remove()}):console.warn("Product or Variant ID missing")})}),T)for(const t of T){const r=t.getAttribute("data-product-id"),o=t.getAttribute("data-variant-id");try{await M(r,o)&&(t.classList.add("bg-primary","text-white"),t.innerHTML=`
                                    <svg width="18" height="18" class="d-block flex-shrink-0">
                                        <use href="./src/assets/images/sprite.svg#heartFill"></use>
                                    </svg>
                                `)}catch(u){console.log(u)}t.addEventListener("click",async u=>{u.preventDefault(),document.querySelectorAll(".alert").forEach(f=>f.remove()),t.disabled=!0,t.innerHTML='<div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">Loading...</span></div>';const p=t.getAttribute("data-product-id"),i=t.getAttribute("data-variant-id");try{const f=await ae({productId:p,variantId:i});f==="ADDED"?(t.parentElement.insertAdjacentHTML("afterend",v("Product Added To Favorites","success")),t.classList.add("bg-primary","text-white"),t.innerHTML=`
                                        <svg width="18" height="18" class="d-block flex-shrink-0">
                                            <use href="./src/assets/images/sprite.svg#heartFill"></use>
                                        </svg>
                                    `):f==="EXISTS"&&(t.parentElement.insertAdjacentHTML("afterend",v("Product Already Added To Favorites","danger")),t.innerHTML=`
                                        <svg width="18" height="18" class="d-block flex-shrink-0">
                                            <use href="./src/assets/images/sprite.svg#heartFill"></use>
                                        </svg>
                                    `)}catch(f){console.log(f)}finally{t.disabled=!1}})}e.forEach((t,r)=>{new j(t,{perPage:1,arrows:!1,pagination:!0,drag:!1}).mount();const u=g[r];if(!u||!u.variants)return;const p=t.querySelectorAll(".splide__pagination__page");u.variants.forEach((i,f)=>{const L=p[f];if(!L||!i.colors)return;const ie=i.colors.map(E=>i.colors.length>1?`${E} ${100/i.colors.length}%`:E).join(", ");L.style.cssText=`
                            --variant-base-color: ${i.colors[0]};
                            background-image: linear-gradient( -45deg, ${ie} );
                            box-shadow: 0 0 0 0.125rem ${i.colors[0]};
                        `,L.setAttribute("data-variant-id",`${i.id}`),L.addEventListener("click",()=>{const E=i.id,P=a[r],_=b[r],A=T[r];if(!P||!_)return;const F=new URL(P.href,window.location.origin);F.searchParams.delete("variantId"),F.searchParams.append("variantId",E),P.href=F.toString(),_.setAttribute("data-variant-id",`${E}`),A.setAttribute("data-variant-id",`${E}`);const de=A.getAttribute("data-product-id");M(de,E).then(H=>{H?(A.classList.add("bg-primary","text-white"),A.innerHTML=`
                                        <svg width="18" height="18" class="d-block flex-shrink-0">
                                            <use href="./src/assets/images/sprite.svg#heartFill"></use>
                                        </svg>
                                    `):(A.classList.remove("bg-primary","text-white"),A.innerHTML=`
                                        <svg width="18" height="18" class="d-block flex-shrink-0">
                                            <use href="./src/assets/images/sprite.svg#heart"></use>
                                        </svg>
                                    `)}).catch(H=>{console.log(H)})})})})})()})}catch(s){console.log(s),m.insertAdjacentHTML("beforeend",v("Error Loading Products.","danger"))}finally{const s=document.getElementById("productCardSkeleton");s&&s.remove()}};let B=null,$=null;const R=(n,d)=>{n!=null&&n.splide&&n.splide.destroy(!0),d!=null&&d.splide&&d.splide.destroy(!0),$=new j(d,{fixedWidth:100,height:100,gap:12,pagination:!1,arrows:!1,isNavigation:!0}),B=new j(n,{pagination:!1,arrows:!1}),B.sync($),B.mount(),$.mount()},ye=(n,d)=>{var s;const m=document.createElement("ul");return m.classList.add("varients","list-inline","d-flex","align-items-center","gap-3","mt-0"),(s=n.variants)==null||s.forEach(c=>{var g;const l=`
            <li class="mb-0">
                <button class="varient-button d-block rounded-circle transition-3 ${c.id===d?"active":null}" style="--variant-base-color: ${c.colors[0]};background-image: linear-gradient( -135deg, ${(g=c.colors)==null?void 0:g.map(e=>c.colors.length>1?`${e} ${100/c.colors.length}%`:`${e}`).join(", ")} );box-shadow: 0 0 0 0.125rem ${c.colors[0]};" data-varient-id="${c.id}"></button>
            </li>
        `;m.insertAdjacentHTML("beforeend",l)}),m},be=(n,d,m,s=10)=>{const c=s===0?0:1,l=()=>{let e=parseInt(n.value)||1;(isNaN(e)||e<c)&&(e=c),e>s&&(e=s),n.value=e,g(e)},g=e=>{d.disabled=e>=s,m.disabled=e<=c};n.addEventListener("input",()=>n.value=n.value.replace(/[^0-9]/g,"")),n.addEventListener("blur",l),n.addEventListener("change",()=>{let e=parseInt(n.value)||c;g(e)}),d.addEventListener("click",e=>{e.preventDefault();let a=parseInt(n.value)||c;a<s&&a++,n.value=a,g(a)}),m.addEventListener("click",e=>{e.preventDefault();let a=parseInt(n.value)||c;a>c&&a--,n.value=a,g(a)}),l()},Ee=`
    <button id="addToFavorite" class="btn bg-primary text-white btn-sm d-flex align-items-center gap-2">
        <svg width="18" height="18" class="d-block">
            <use href="./src/assets/images/sprite.svg#heartFill"></use>
        </svg>
        <span class="d-block">Favorites</span>
    </button>
`,N=(n,d,m,s)=>{n.addEventListener("click",c=>{c.preventDefault(),document.querySelectorAll(".alert").forEach(l=>l.remove()),n.disabled=!0,n.insertAdjacentHTML("beforeend",'<div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">Loading...</span></div>'),ae({productId:m,variantId:s}).then(l=>{if(l==="ADDED"){d.innerHTML=Ee;const g=document.getElementById("addToFavorite");g&&N(g,d,m,s),d.parentElement.insertAdjacentHTML("afterend",v("Product Added To Favorites","success","d-inline-flex"))}else l==="EXISTS"&&d.parentElement.insertAdjacentHTML("afterend",v("Product Already Added To Favorites","danger","d-inline-flex"))}).catch(l=>{console.log(l)}).finally(()=>{n.disabled=!1;const l=n.querySelector(".spinner-border");l&&l.remove()})})},V=document.getElementById("productCategory"),Q=document.querySelector("#productImageWrapper .splide__list"),O=document.querySelector(".product-variant-slider"),X=document.querySelector(".product-variant-thumbnail-slider"),W=document.querySelector(".product-variant-thumbnail-slider .splide__list"),z=document.getElementById("productName"),U=document.getElementById("productShortDescription"),J=document.getElementById("productRating"),G=document.getElementById("sku"),K=document.getElementById("variantsContainer"),Y=document.getElementById("productDetailedDescription"),Z=document.getElementById("selectedProductName"),x=document.getElementById("selectedProductImg"),w=document.getElementById("selectedProductColor"),S=document.getElementById("selectedProductQuantity"),h=document.querySelector("#quantity #quantityInput"),C=document.querySelector("#quantity #plus"),D=document.querySelector("#quantity #minus"),I=document.getElementById("stock"),q=document.getElementById("totalPrice"),ee=document.getElementById("buyNow"),y=document.getElementById("addToCart"),k=document.querySelector(".favorite-button-container"),Te=document.getElementById("relatedProducts"),te=`
    <button id="addToFavorite" class="btn btn-sm bg-transparent text-primary d-flex align-items-center gap-2 border-primary">
        <svg width="18" height="18" class="d-block">
            <use href="./src/assets/images/sprite.svg#heart"></use>
        </svg>
        <span class="d-block">Add to Favorites</span>
    </button>
`,ne=`
    <button id="addToFavorite" class="btn bg-primary text-white btn-sm d-flex align-items-center gap-2">
        <svg width="18" height="18" class="d-block">
            <use href="./src/assets/images/sprite.svg#heartFill"></use>
        </svg>
        <span class="d-block">Favorites</span>
    </button>
`,Le=async()=>{var c;const n=new URLSearchParams(window.location.search),d=n.get("id"),m=n.get("variantId");let s=parseInt(h.value)||1;try{const l=ge(re,"collections","products","items",d),g=await pe(l);if(g.exists()){const e=g.data();console.log(e);let a=m;document.title=`Product | ${e.name}`,V&&(V.textContent=e.category),z&&(z.textContent=e.name),U&&(U.textContent=e.shortDescription),J&&(J.textContent=`${e.rating} Ratings`),G&&(G.textContent=e.sku),K&&K.append(ye(e,a));const b=document.querySelectorAll(".varient-button"),T=e.variants.find(r=>r.id===a);if(e.variants.length>0&&T.images.length>0){const r=(c=T.images)==null?void 0:c.map(o=>`
                    <li class="splide__slide mb-0">
                        <img src="${o}" alt="${e.name}" class="d-block img-fluid mx-auto" />
                    </li>
                `).join("");Q.innerHTML=r,W.innerHTML=r}M(d,a).then(r=>{r?k.innerHTML=ne:k.innerHTML=te,requestAnimationFrame(()=>{const o=document.getElementById("addToFavorite");o&&N(o,k,d,a)})}),requestAnimationFrame(()=>R(O,X)),b==null||b.forEach(r=>{r.addEventListener("click",()=>{var u;b.forEach(p=>p.classList.remove("active")),r.classList.add("active");const o=r.getAttribute("data-varient-id");a!==o&&(a=o,M(d,a).then(p=>{p?k.innerHTML=ne:k.innerHTML=te,requestAnimationFrame(()=>{const i=document.getElementById("addToFavorite");i&&N(i,k,d,a)})}),(u=e.variants)==null||u.forEach(p=>{var i;if(p.id===o){const f=(i=p.images)==null?void 0:i.map(L=>`<li class="splide__slide mb-0"><img src="${L}" alt="${e.name}" class="d-block img-fluid mx-auto" /></li>`).join("");Q.innerHTML=f,W.innerHTML=f,requestAnimationFrame(()=>R(O,X)),x&&(x.innerHTML=`<img src="${p.images[0]}" alt="${e.name}" class="d-block img-fluid mx-auto" /> `),w&&(w.innerHTML=`<span class="current-variant-color d-block rounded-circle" style="background-color: ${p.colors[0]};"></span>`)}}))})}),Y&&Y.insertAdjacentHTML("beforeend",`
                <p>${e.detailedDescription}</p>
                <ul class="list-inline">
                    ${Object.keys(e.specifications).map(r=>`
                            <li class="d-flex align-items-center gap-2">
                                <span class="d-block">${r}: </span>
                                <span class="d-block fw-semibold">${e.specifications[r]}</span>
                            </li>
                        `).join("")}
                </ul>
            `),e.variants.forEach(r=>{r.id===a&&(x&&(x.innerHTML=`<img src="${r.images[0]}" alt="${e.name}" class="d-block img-fluid mx-auto" /> `),w&&(w.innerHTML=`<span class="current-variant-color d-block rounded-circle" style="background-color: ${r.colors[0]};"></span>`))}),Z&&(Z.textContent=e.name),S&&(S.textContent=s),be(h,C,D,e.inStock),e.inStock===0&&(h.value=0,h.disabled=!0,C.disabled=!0,D.disabled=!0,I&&(I.textContent="Out of Stock"));const t=()=>{if(s=parseInt(h.value)||0,s>e.inStock&&(s=e.inStock,h.value=s),e.inStock===0){q&&(q.textContent="₹ 0.00"),I&&(I.textContent="Out of Stock");return}q&&(q.textContent=`₹ ${parseInt(e.price.current)*s}.00`),I&&(I.textContent=e.inStock-s),S&&(S.textContent=s)};t(),h.addEventListener("input",t),h.addEventListener("blur",t),h.addEventListener("change",t),C.addEventListener("click",t),D.addEventListener("click",t),ee&&ee.addEventListener("click",()=>{var r,o;sessionStorage.setItem("buyNowItem",JSON.stringify({id:d,variantId:a,name:e.name,productImage:(r=e.variants)==null?void 0:r.find(u=>u.id===a).images[0],quantity:s,sku:e.sku,variant:(o=e.variants)==null?void 0:o.find(u=>u.id===a).colors,price:e.price.current})),window.location.href="./checkout.html?buyNow=true"}),y&&y.addEventListener("click",r=>{r.preventDefault(),document.querySelectorAll(".alert").forEach(o=>o.remove()),y.disabled=!0,y.insertAdjacentHTML("beforeend",'<div class="spinner-border spinner-border-sm text-light" role="status"><span class="visually-hidden">Loading...</span></div>'),oe(d,a,s).then(o=>{o==="ADDED"?(y.parentElement.insertAdjacentHTML("afterend",v("Product Added To Cart","success")),se()):o==="EXISTS"&&y.parentElement.insertAdjacentHTML("afterend",v("Product Already Exist"))}).catch(o=>{console.log("Failed to add to cart",o)}).finally(()=>{y.disabled=!1;const o=y.querySelector(".spinner-border");o&&o.remove()})}),he(e.id,e.category,Te)}else console.log("No such Product Found!")}catch(l){console.log(l)}};Le();

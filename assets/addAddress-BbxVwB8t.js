import{b as H,d as g,e as B,u as w,a as c,n as F,c as q}from"./alert-DMWuZ5g4.js";import{g as D}from"./header-_iNkTwr9.js";import"./sidebar-BEAag9fV.js";import{C as O,S}from"./state-AGKt8l62.js";import{C as E}from"./city-BZRNjcdY.js";const r=document.getElementById("addressForm"),u=document.getElementById("address"),l=document.getElementById("country"),s=document.getElementById("state"),e=document.getElementById("city"),f=document.getElementById("zip"),o=document.getElementById("saveAddress"),y=document.getElementById("description"),v=document.querySelectorAll('input[name="saveAddressAs"]'),P=new URLSearchParams(window.location.search),A=P.get("addressId");let L=null;const z=[u,l,s,e,f,y],M=O.getCountryByCode("IN");let j="",T="";s&&(s.disabled=!0);e&&(e.disabled=!0);l&&(l.insertAdjacentHTML("beforeend",`<option value="${M.isoCode}">${M.name}</option>`),l.addEventListener("change",a=>{j=a.target.value,S.getStatesOfCountry(a.target.value).forEach(d=>{s&&(s.insertAdjacentHTML("beforeend",`<option value="${d.isoCode}">${d.name}</option>`),s.disabled=!1)})}));s&&s.addEventListener("change",a=>{T=a.target.value;const n=E.getCitiesOfState(j,T);e&&(e.innerHTML='<option value="" selected disabled>Select City</option>'),n.forEach(d=>{e&&(e.insertAdjacentHTML("beforeend",`<option value="${d.name}">${d.name}</option>`),e.disabled=!1)})});const h=()=>{let a="";return document.querySelectorAll(".alert").forEach(n=>n.remove()),u&&!u.value.trim()?u.insertAdjacentHTML("afterend",c("Please Enter Your Address")):l&&!l.value.trim()?l.insertAdjacentHTML("afterend",c("Country is required")):s&&!s.value.trim()?s.insertAdjacentHTML("afterend",c("State is required")):e&&!e.value.trim()?e.insertAdjacentHTML("afterend",c("City is required")):f&&!f.value.trim()?f.insertAdjacentHTML("afterend",c("ZIP Code is required")):(v&&v.forEach(n=>{n.checked&&(a=n.value)}),{address:u.value.trim(),country:l.value.trim(),state:s.value.trim(),city:e.value.trim(),zip:f.value.trim(),description:y.value.trim(),default:a})},b=()=>{const a=h(),n=Object.keys(a).some(d=>a[d]!==L[d]);o&&(o.disabled=!n)},R=async()=>{const a=await D();if(a)if(A){o&&(o.disabled=!0);const n=H(g,"users",a.uid,"addresses",A),d=await B(n);if(d.exists()){const t=d.data();L=t,u&&(u.value=t.address||""),l&&(l.value=t.country||""),S.getStatesOfCountry(t.country).forEach(i=>{s&&s.insertAdjacentHTML("beforeend",`<option value="${i.isoCode}">${i.name}</option>`)}),s&&(s.disabled=!1,s.value=t.state||"",s.addEventListener("change",i=>{const I=i.target.value,$=E.getCitiesOfState(t.country,I);e&&(e.innerHTML='<option value="" selected disabled>Select City</option>'),$.forEach(C=>{e&&e.insertAdjacentHTML("beforeend",`<option value="${C.name}">${C.name}</option>`)})}));const m=E.getCitiesOfState(t.country,t.state);e&&(e.innerHTML='<option value="" selected disabled>Select City</option>'),m.forEach(i=>{e&&e.insertAdjacentHTML("beforeend",`<option value="${i.name}">${i.name}</option>`)}),e&&(e.disabled=!1,e.value=t.city||""),f&&(f.value=t.zip||""),y&&(y.value=t.description||""),v&&t.default&&v.forEach(i=>i.checked=i.value===t.default)}z.forEach(t=>{t&&t.addEventListener("input",b)}),v.forEach(t=>{t.addEventListener("change",b)}),r&&r.addEventListener("submit",async t=>{t.preventDefault();const p=h();if(p)try{o&&(o.disabled=!0);const m=H(g,"users",a.uid,"addresses",A);await w(m,p),L=p,b(),r.insertAdjacentHTML("afterbegin",c("Address Updated Successfully!","success","mt-0 mb-4"))}catch(m){console.log(m),r.insertAdjacentHTML("afterbegin",c("Failed to update address"))}})}else r&&r.addEventListener("submit",async n=>{n.preventDefault();const d=h();if(d)try{o&&(o.disabled=!0),await F(q(g,"users",a.uid,"addresses"),d),r.insertAdjacentHTML("afterbegin",c("Address Added Successfully!","success","mt-0 mb-4")),r.reset()}catch(t){console.log(t),r.insertAdjacentHTML("afterbegin",c("Failed to add address"))}finally{o&&(o.disabled=!1)}});else r&&(r.innerHTML="",r.insertAdjacentHTML("afterbegin",c("Please login to Add Address","danger","mt-0 mb-4")))};R();

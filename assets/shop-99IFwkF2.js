import{c as L,d as T,g as w,q as v,w as A}from"./firebase-config-C_Yz0m2T.js";import{u as $}from"./header-0P7B0Tyh.js";import{r as P,a as j,b as H,S as I}from"./addToCart-C7-cc1Bd.js";import{d as m}from"./alert-DsZaPul3.js";const M=(o,r)=>{const t=typeof o=="string"?document.querySelector(o):o;if(!t)return;const c=()=>`
        <span class="placeholder col-5 d-block rounded-32" style="height: 2.5rem;"></span>
    `,e=document.createElement("li");e.className="w-100 d-flex gap-2 flex-wrap mb-0",e.id="categorySkeletonContainer";for(let s=0;s<r;s++)e.insertAdjacentHTML("beforeend",c());t.appendChild(e)},D=async o=>{M(o,5);try{const r=L(T,"collections","categories","items"),t=await w(r);if(t.empty){o.insertAdjacentHTML("beforeend",m("No Categories Found.","danger"));return}t.forEach(c=>{const e=c.data();o.insertAdjacentHTML("beforeend",`
                <li class="mb-0">
                    <label for="${e.id}" class="px-3 py-2 border rounded-32 transition-3 cursor-pointer">
                        <input type="checkbox" id="${e.id}" name="${e.id}" data-category="${e.name}" class="category-checkbox d-none" />
                        <span class="d-block">${e.name}</span>
                    </label>
                </li>
            `)})}catch(r){console.log(r)}finally{const r=document.getElementById("categorySkeletonContainer");r&&r.remove()}},p=document.getElementById("productsContainer"),b=document.getElementById("categoriesContainer"),S=async(o=null,r=null)=>{p.innerHTML="",P(p,9);try{let t=L(T,"collections","products","items");if(o&&o.length>0&&(t=v(t,A("category","in",o))),r){const[e,s]=r;t=v(t,A("price",">=",e),A("price","<=",s))}const c=await w(t);if(c.empty){p.insertAdjacentHTML("beforeend",m("No Products Found."));return}c.forEach(e=>{const s=e.data();p.insertAdjacentHTML("beforeend",j(s))}),requestAnimationFrame(()=>{const e=document.querySelectorAll(".variant-images"),s=document.querySelectorAll(".product-title"),C=document.querySelectorAll(".add-to-cart");C.forEach(n=>{n.addEventListener("click",l=>{l.preventDefault(),document.querySelectorAll(".alert").forEach(a=>a.remove()),n.disabled=!0,n.insertAdjacentHTML("beforeend",'<div class="spinner-border spinner-border-sm text-light" role="status"><span class="visually-hidden">Loading...</span></div>');const f=n.getAttribute("data-product-id"),i=n.getAttribute("data-variant-id");f&&i?H(f,i,1).then(a=>{a==="ADDED"?(n.parentElement.insertAdjacentHTML("afterend",m("Product Added To Cart","success","fs-xs")),$()):a==="EXISTS"&&n.parentElement.insertAdjacentHTML("afterend",m("Product Already Exist","danger","fs-xs"))}).catch(a=>{console.log("Failed to add to cart",a)}).finally(()=>{n.disabled=!1;const a=n.querySelector(".spinner-border");a&&a.remove()}):console.warn("Product or Variant ID missing")})}),e.forEach((n,l)=>{var a;new I(n,{perPage:1,arrows:!1,pagination:!0,drag:!1}).mount();const i=(a=c.docs[l])==null?void 0:a.data();if(!i||!i.variants)return;const E=n.querySelectorAll(".splide__pagination__page");i.variants.forEach((d,x)=>{const g=E[x];if(!g||!d.colors)return;const q=d.colors.map(u=>d.colors.length>1?`${u} ${100/d.colors.length}%`:u).join(", ");g.style.cssText=`
                        --variant-base-color: ${d.colors[0]};
                        background-image: linear-gradient( -45deg, ${q} );
                        box-shadow: 0 0 0 0.125rem ${d.colors[0]};
                    `,g.setAttribute("data-variant-id",`${d.id}`),g.addEventListener("click",()=>{const u=d.id,y=s[l],k=C[l];if(!y||!k)return;const h=new URL(y.href,window.location.origin);h.searchParams.delete("variantId"),h.searchParams.append("variantId",u),y.href=h.toString(),k.setAttribute("data-variant-id",`${u}`)})})})})}catch(t){console.log(t),p.insertAdjacentHTML("beforeend",m("Error Loading Products."))}finally{const t=document.getElementById("productCardSkeleton");t&&t.remove()}};S();b&&D(b).then(()=>{const o=b.querySelectorAll("input.category-checkbox");o.forEach(r=>{r.addEventListener("change",t=>{t.preventDefault(),r.getAttribute("data-category");const c=Array.from(o).filter(e=>e.checked).map(e=>e.getAttribute("data-category"));r.checked?r.parentElement.classList.add("bg-primary","text-white"):r.parentElement.classList.remove("bg-primary","text-white"),c.length===0?S(null):S(c)})})});

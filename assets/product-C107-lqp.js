import{c as Y,d as J,q as Z,w as ee,g as te,a as ne,h as oe}from"./firebase-config-BeTxBtPS.js";import{u as G}from"./header-C7f_UmUr.js";import{r as re,a as ae,b as K,S as M}from"./addToCart-CyGaIFsk.js";import{d as b}from"./alert-DsZaPul3.js";const ce=async(n,d,l)=>{re(l,3);try{const t=Y(J,"collections","products","items"),s=Z(t,ee("category","==",d)),p=await te(s);if(p.empty){l.insertAdjacentHTML("beforeend",b("No Products Found.","danger"));return}const u=[];p.forEach(e=>{const r=e.data();r.id!==n&&(u.push(r),l.insertAdjacentHTML("beforeend",ae(r)))}),u.length===0&&l.insertAdjacentHTML("beforeend",b("No related products found.","danger","bi-exclamation-diamond-fill","mx-2")),requestAnimationFrame(()=>{const e=document.querySelectorAll(".variant-images"),r=document.querySelectorAll(".product-title"),y=document.querySelectorAll(".add-to-cart");y.forEach(i=>{i.addEventListener("click",m=>{m.preventDefault(),document.querySelectorAll(".alert").forEach(o=>o.remove()),i.disabled=!0,i.insertAdjacentHTML("beforeend",'<div class="spinner-border spinner-border-sm text-light" role="status"><span class="visually-hidden">Loading...</span></div>');const c=i.getAttribute("data-product-id"),a=i.getAttribute("data-variant-id");c&&a?K(c,a,1).then(o=>{o==="ADDED"?(i.parentElement.insertAdjacentHTML("afterend",b("Product Added To Cart","success","bi-check-circle-fill","fs-xs")),G()):o==="EXISTS"&&i.parentElement.insertAdjacentHTML("afterend",b("Product Already Exist","danger","bi-exclamation-diamond-fill","fs-xs"))}).catch(o=>{console.log("Failed to add to cart",o)}).finally(()=>{i.disabled=!1;const o=i.querySelector(".spinner-border");o&&o.remove()}):console.warn("Product or Variant ID missing")})}),e.forEach((i,m)=>{new M(i,{perPage:1,arrows:!1,pagination:!0,drag:!1}).mount();const a=u[m];if(!a||!a.variants)return;const h=i.querySelectorAll(".splide__pagination__page");a.variants.forEach((o,L)=>{const v=h[L];if(!v||!o.colors)return;const k=o.colors.map(I=>o.colors.length>1?`${I} ${100/o.colors.length}%`:I).join(", ");v.style.cssText=`
                        --variant-base-color: ${o.colors[0]};
                        background-image: linear-gradient( -45deg, ${k} );
                        box-shadow: 0 0 0 0.125rem ${o.colors[0]};
                    `,v.setAttribute("data-variant-id",`${o.id}`),v.addEventListener("click",()=>{const I=o.id,q=r[m],B=y[m];if(!q||!B)return;const C=new URL(q.href,window.location.origin);C.searchParams.delete("variantId"),C.searchParams.append("variantId",I),q.href=C.toString(),B.setAttribute("data-variant-id",`${I}`)})})})})}catch(t){console.log(t),l.insertAdjacentHTML("beforeend",b("Error Loading Products.","danger"))}finally{const t=document.getElementById("productCardSkeleton");t&&t.remove()}};let $=null,x=null;const H=(n,d)=>{n!=null&&n.splide&&n.splide.destroy(!0),d!=null&&d.splide&&d.splide.destroy(!0),x=new M(d,{fixedWidth:100,height:100,gap:12,pagination:!1,arrows:!1,isNavigation:!0}),$=new M(n,{pagination:!1,arrows:!1}),$.sync(x),$.mount(),x.mount()},se=(n,d)=>{var t;const l=document.createElement("ul");return l.classList.add("varients","list-inline","d-flex","align-items-center","gap-3","mt-0"),(t=n.variants)==null||t.forEach(s=>{var u;const p=`
            <li class="mb-0">
                <button class="varient-button d-block rounded-circle transition-3 ${s.id===d?"active":null}" style="--variant-base-color: ${s.colors[0]};background-image: linear-gradient( -135deg, ${(u=s.colors)==null?void 0:u.map(e=>s.colors.length>1?`${e} ${100/s.colors.length}%`:`${e}`).join(", ")} );box-shadow: 0 0 0 0.125rem ${s.colors[0]};" data-varient-id="${s.id}"></button>
            </li>
        `;l.insertAdjacentHTML("beforeend",p)}),l},de=(n,d,l,t=10)=>{const s=t===0?0:1,p=()=>{let e=parseInt(n.value)||1;(isNaN(e)||e<s)&&(e=s),e>t&&(e=t),n.value=e,u(e)},u=e=>{d.disabled=e>=t,l.disabled=e<=s};n.addEventListener("input",()=>n.value=n.value.replace(/[^0-9]/g,"")),n.addEventListener("blur",p),n.addEventListener("change",()=>{let e=parseInt(n.value)||s;u(e)}),d.addEventListener("click",e=>{e.preventDefault();let r=parseInt(n.value)||s;r<t&&r++,n.value=r,u(r)}),l.addEventListener("click",e=>{e.preventDefault();let r=parseInt(n.value)||s;r>s&&r--,n.value=r,u(r)}),p()},j=document.getElementById("productCategory"),N=document.querySelector("#productImageWrapper .splide__list"),_=document.querySelector(".product-variant-slider"),R=document.querySelector(".product-variant-thumbnail-slider"),V=document.querySelector(".product-variant-thumbnail-slider .splide__list"),F=document.getElementById("productName"),Q=document.getElementById("productShortDescription"),O=document.getElementById("productRating"),W=document.getElementById("variantsContainer"),z=document.getElementById("productDetailedDescription"),U=document.getElementById("selectedProductName"),T=document.getElementById("selectedProductImg"),A=document.getElementById("selectedProductColor"),P=document.getElementById("selectedProductQuantity"),f=document.querySelector("#quantity #quantityInput"),w=document.querySelector("#quantity #plus"),D=document.querySelector("#quantity #minus"),E=document.getElementById("stock"),S=document.getElementById("totalPrice"),X=document.getElementById("buyNow"),g=document.getElementById("addToCart"),ie=document.getElementById("relatedProducts"),le=async()=>{var s;const n=new URLSearchParams(window.location.search),d=n.get("id"),l=n.get("variantId");let t=parseInt(f.value)||1;try{const p=ne(J,"collections","products","items",d),u=await oe(p);if(u.exists()){const e=u.data();let r=l;document.title=`Product | ${e.name}`,j&&(j.textContent=e.category),F&&(F.textContent=e.name),Q&&(Q.textContent=e.shortDescription),O&&(O.textContent=`${e.rating} Ratings`),W&&W.append(se(e,r));const y=document.querySelectorAll(".varient-button"),i=e.variants.find(c=>c.id===r);if(e.variants.length>0&&i.images.length>0){const c=(s=i.images)==null?void 0:s.map(a=>`
                    <li class="splide__slide mb-0">
                        <img src="${a}" alt="${e.name}" class="d-block img-fluid mx-auto" />
                    </li>
                `).join("");N.innerHTML=c,V.innerHTML=c}requestAnimationFrame(()=>H(_,R)),y==null||y.forEach(c=>{c.addEventListener("click",()=>{var h;y.forEach(o=>o.classList.remove("active")),c.classList.add("active");const a=c.getAttribute("data-varient-id");r!==a&&(r=a,(h=e.variants)==null||h.forEach(o=>{var L;if(o.id===a){const v=(L=o.images)==null?void 0:L.map(k=>`<li class="splide__slide mb-0"><img src="${k}" alt="${e.name}" class="d-block img-fluid mx-auto" /></li>`).join("");N.innerHTML=v,V.innerHTML=v,requestAnimationFrame(()=>H(_,R)),T&&(T.innerHTML=`<img src="${o.images[0]}" alt="${e.name}" class="d-block img-fluid mx-auto" /> `),A&&(A.innerHTML=`<span class="current-variant-color d-block rounded-circle" style="background-color: ${o.colors[0]};"></span>`)}}))})}),z&&z.insertAdjacentHTML("beforeend",`
                <p>${e.detailedDescription}</p>
                <ul class="list-inline">
                    ${Object.keys(e.specifications).map(c=>`
                            <li class="d-flex align-items-center gap-2">
                                <span class="d-block">${c}: </span>
                                <span class="d-block fw-semibold">${e.specifications[c]}</span>
                            </li>
                        `).join("")}
                </ul>
            `),e.variants.forEach(c=>{c.id===r&&(T&&(T.innerHTML=`<img src="${c.images[0]}" alt="${e.name}" class="d-block img-fluid mx-auto" /> `),A&&(A.innerHTML=`<span class="current-variant-color d-block rounded-circle" style="background-color: ${c.colors[0]};"></span>`))}),U&&(U.textContent=e.name),P&&(P.textContent=t),de(f,w,D,e.inStock),e.inStock===0&&(f.value=0,f.disabled=!0,w.disabled=!0,D.disabled=!0,E&&(E.textContent="Out of Stock"));const m=()=>{if(t=parseInt(f.value)||0,t>e.inStock&&(t=e.inStock,f.value=t),e.inStock===0){S&&(S.textContent="₹ 0.00"),E&&(E.textContent="Out of Stock");return}S&&(S.textContent=`₹ ${parseInt(e.price.current)*t}.00`),E&&(E.textContent=e.inStock-t),P&&(P.textContent=t)};m(),f.addEventListener("input",m),f.addEventListener("blur",m),f.addEventListener("change",m),w.addEventListener("click",m),D.addEventListener("click",m),X&&X.addEventListener("click",()=>{sessionStorage.setItem("buyNowItem",JSON.stringify({productId:d,productVariant:r,productQuantity:t})),window.location.href="./checkout.html?buyNow=true"}),g&&g.addEventListener("click",c=>{c.preventDefault(),document.querySelectorAll(".alert").forEach(a=>a.remove()),g.disabled=!0,g.insertAdjacentHTML("beforeend",'<div class="spinner-border spinner-border-sm text-light" role="status"><span class="visually-hidden">Loading...</span></div>'),K(d,r,t).then(a=>{a==="ADDED"?(g.parentElement.insertAdjacentHTML("afterend",b("Product Added To Cart","success")),G()):a==="EXISTS"&&g.parentElement.insertAdjacentHTML("afterend",b("Product Already Exist"))}).catch(a=>{console.log("Failed to add to cart",a)}).finally(()=>{g.disabled=!1;const a=g.querySelector(".spinner-border");a&&a.remove()})}),ce(e.id,e.category,ie)}else console.log("No such Product Found!")}catch(p){console.log(p)}};le();

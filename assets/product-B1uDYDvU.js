import{c as X,d as U,q as G,w as K,g as Y,a as h,f as Z,h as ee}from"./alert-DvhDq9MJ.js";import{u as te}from"./header-CN8bIxoT.js";import{r as ne,a as oe,b as re,S as x}from"./addToCart-CSV7XBuy.js";const ae=async(n,i,c)=>{ne(c,3);try{const r=X(U,"collections","products","items"),d=G(r,K("category","==",i)),u=await Y(d);if(u.empty){c.insertAdjacentHTML("beforeend",h("No Products Found.","danger"));return}const e=[];u.forEach(o=>{const a=o.data();a.id!==n&&(e.push(a),c.insertAdjacentHTML("beforeend",oe(a)))}),e.length===0&&c.insertAdjacentHTML("beforeend",h("No related products found.","danger","bi-exclamation-diamond-fill","mx-2")),requestAnimationFrame(()=>{const o=document.querySelectorAll(".variant-images"),a=document.querySelectorAll(".product-title"),p=document.querySelectorAll(".add-to-cart");p.forEach(t=>{t.addEventListener("click",m=>{m.preventDefault(),document.querySelectorAll(".alert").forEach(s=>s.remove()),t.disabled=!0,t.insertAdjacentHTML("beforeend",'<div class="spinner-border spinner-border-sm text-light" role="status"><span class="visually-hidden">Loading...</span></div>');const g=t.getAttribute("data-product-id"),l=t.getAttribute("data-variant-id");g&&l?re(g,l,1).then(s=>{s==="ADDED"?(t.parentElement.insertAdjacentHTML("afterend",h("Product Added To Cart","success","bi-check-circle-fill","fs-xs")),te()):s==="EXISTS"&&t.parentElement.insertAdjacentHTML("afterend",h("Product Already Exist","danger","bi-exclamation-diamond-fill","fs-xs"))}).catch(s=>{console.log("Failed to add to cart",s)}).finally(()=>{t.disabled=!1;const s=t.querySelector(".spinner-border");s&&s.remove()}):console.warn("Product or Variant ID missing")})}),o.forEach((t,m)=>{new x(t,{perPage:1,arrows:!1,pagination:!0,drag:!1}).mount();const l=e[m];if(!l||!l.variants)return;const v=t.querySelectorAll(".splide__pagination__page");l.variants.forEach((s,q)=>{const E=v[q];if(!E||!s.colors)return;const J=s.colors.map(b=>s.colors.length>1?`${b} ${100/s.colors.length}%`:b).join(", ");E.style.cssText=`
                        --variant-base-color: ${s.colors[0]};
                        background-image: linear-gradient( -45deg, ${J} );
                        box-shadow: 0 0 0 0.125rem ${s.colors[0]};
                    `,E.setAttribute("data-variant-id",`${s.id}`),E.addEventListener("click",()=>{const b=s.id,$=a[m],M=p[m];if(!$||!M)return;const C=new URL($.href,window.location.origin);C.searchParams.delete("variantId"),C.searchParams.append("variantId",b),$.href=C.toString(),M.setAttribute("data-variant-id",`${b}`)})})})})}catch(r){console.log(r),c.insertAdjacentHTML("beforeend",h("Error Loading Products.","danger"))}finally{const r=document.getElementById("productCardSkeleton");r&&r.remove()}};let S=null,T=null;const B=(n,i)=>{n!=null&&n.splide&&n.splide.destroy(!0),i!=null&&i.splide&&i.splide.destroy(!0),T=new x(i,{fixedWidth:100,height:100,gap:12,pagination:!1,arrows:!1,isNavigation:!0}),S=new x(n,{pagination:!1,arrows:!1}),S.sync(T),S.mount(),T.mount()},ce=n=>{var c;const i=document.createElement("ul");return i.classList.add("varients","list-inline","d-flex","align-items-center","gap-3","mt-0"),(c=n.variants)==null||c.forEach(r=>{var u;const d=`
            <li class="mb-0">
                <button class="varient-button d-block rounded-circle transition-3" style="--variant-base-color: ${r.colors[0]};background-image: linear-gradient( -135deg, ${(u=r.colors)==null?void 0:u.map(e=>r.colors.length>1?`${e} ${100/r.colors.length}%`:`${e}`).join(", ")} );box-shadow: 0 0 0 0.125rem ${r.colors[0]};" data-varient-id="${r.id}"></button>
            </li>
        `;i.insertAdjacentHTML("beforeend",d)}),i},se=(n,i,c,r=10)=>{const d=r===0?0:1,u=()=>{let o=parseInt(n.value)||1;(isNaN(o)||o<d)&&(o=d),o>r&&(o=r),n.value=o,e(o)},e=o=>{i.disabled=o>=r,c.disabled=o<=d};n.addEventListener("input",()=>n.value=n.value.replace(/[^0-9]/g,"")),n.addEventListener("blur",u),n.addEventListener("change",()=>{let o=parseInt(n.value)||d;e(o)}),i.addEventListener("click",o=>{o.preventDefault();let a=parseInt(n.value)||d;a<r&&a++,n.value=a,e(a)}),c.addEventListener("click",o=>{o.preventDefault();let a=parseInt(n.value)||d;a>d&&a--,n.value=a,e(a)}),u()},D=document.getElementById("productCategory"),H=document.querySelector("#productImageWrapper .splide__list"),N=document.querySelector(".product-variant-slider"),j=document.querySelector(".product-variant-thumbnail-slider"),_=document.querySelector(".product-variant-thumbnail-slider .splide__list"),R=document.getElementById("productName"),V=document.getElementById("productShortDescription"),F=document.getElementById("productRating"),Q=document.getElementById("variantsContainer"),O=document.getElementById("productDetailedDescription"),W=document.getElementById("selectedProductName"),I=document.getElementById("selectedProductImg"),L=document.getElementById("selectedProductColor"),k=document.getElementById("selectedProductQuantity"),f=document.querySelector("#quantity #quantityInput"),A=document.querySelector("#quantity #plus"),w=document.querySelector("#quantity #minus"),y=document.getElementById("stock"),P=document.getElementById("totalPrice"),z=document.getElementById("buyNow"),ie=document.getElementById("relatedProducts"),de=async()=>{var r;const n=new URLSearchParams(window.location.search),i=n.get("id");n.get("variantId");let c=parseInt(f.value)||1;try{const d=Z(U,"collections","products","items",i),u=await ee(d);if(u.exists()){const e=u.data();let o=e.variants[0].id;document.title=`Product | ${e.name}`,D&&(D.textContent=e.category),R&&(R.textContent=e.name),V&&(V.textContent=e.shortDescription),F&&(F.textContent=`${e.rating} Ratings`),Q&&Q.append(ce(e));const a=document.querySelectorAll(".varient-button");if(e.variants.length>0&&e.variants[0].images.length>0){const t=(r=e.variants[0].images)==null?void 0:r.map(m=>`
                    <li class="splide__slide mb-0">
                        <img src="${m}" alt="${e.name}" class="d-block img-fluid mx-auto" />
                    </li>
                `).join("");H.innerHTML=t,_.innerHTML=t}requestAnimationFrame(()=>B(N,j)),a.length>0&&a[0].classList.add("active"),a==null||a.forEach(t=>{t.addEventListener("click",()=>{var g;a.forEach(l=>l.classList.remove("active")),t.classList.add("active");const m=t.getAttribute("data-varient-id");o!==m&&(o=m,(g=e.variants)==null||g.forEach(l=>{var v;if(l.id===m){const s=(v=l.images)==null?void 0:v.map(q=>`<li class="splide__slide mb-0"><img src="${q}" alt="${e.name}" class="d-block img-fluid mx-auto" /></li>`).join("");H.innerHTML=s,_.innerHTML=s,requestAnimationFrame(()=>B(N,j)),I&&(I.innerHTML=`<img src="${l.images[0]}" alt="${e.name}" class="d-block img-fluid mx-auto" /> `),L&&(L.innerHTML=`<span class="current-variant-color d-block rounded-circle" style="background-color: ${l.colors[0]};"></span>`)}}))})}),O&&O.insertAdjacentHTML("beforeend",`
                <p>${e.detailedDescription}</p>
                <ul class="list-inline">
                    ${Object.keys(e.specifications).map(t=>`
                            <li class="d-flex align-items-center gap-2">
                                <span class="d-block">${t}: </span>
                                <span class="d-block fw-semibold">${e.specifications[t]}</span>
                            </li>
                        `).join("")}
                </ul>
            `),e.variants.forEach(t=>{t.id===o&&(I&&(I.innerHTML=`<img src="${t.images[0]}" alt="${e.name}" class="d-block img-fluid mx-auto" /> `),L&&(L.innerHTML=`<span class="current-variant-color d-block rounded-circle" style="background-color: ${t.colors[0]};"></span>`))}),W&&(W.textContent=e.name),k&&(k.textContent=c),se(f,A,w,e.inStock),e.inStock===0&&(f.value=0,f.disabled=!0,A.disabled=!0,w.disabled=!0,y&&(y.textContent="Out of Stock"));const p=()=>{if(c=parseInt(f.value)||0,c>e.inStock&&(c=e.inStock,f.value=c),e.inStock===0){P&&(P.textContent="₹ 0.00"),y&&(y.textContent="Out of Stock");return}P&&(P.textContent=`₹ ${parseInt(e.price.current)*c}.00`),y&&(y.textContent=e.inStock-c),k&&(k.textContent=c)};p(),f.addEventListener("input",p),f.addEventListener("blur",p),f.addEventListener("change",p),A.addEventListener("click",p),w.addEventListener("click",p),z&&z.addEventListener("click",()=>{sessionStorage.setItem("buyNowItem",JSON.stringify({productId:i,productVariant:o,productQuantity:c})),window.location.href="./checkout.html?buyNow=true"}),ae(e.id,e.category,ie)}else console.log("No such Product Found!")}catch(d){console.log(d)}};de();

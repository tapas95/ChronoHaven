import{c as O,d as V,q as W,w as z,g as J,h as U,k as G}from"./firebase-config-t6koYE1i.js";import"./header-C-Elrbao.js";import{r as K,a as X,S}from"./productCardSkeleton-C22IvLv4.js";import{d as k}from"./alert-CO0lNkg5.js";const Y=async(t,s,c)=>{K(c,3);try{const r=O(V,"collections","products","items"),a=W(r,z("category","==",s)),l=await J(a);if(l.empty){c.insertAdjacentHTML("beforeend",k("No Products Found.","danger"));return}const e=[];l.forEach(n=>{const o=n.data();o.id!==t&&(e.push(o),c.insertAdjacentHTML("beforeend",X(o)))}),e.length===0&&c.insertAdjacentHTML("beforeend",k("No related products found.","danger","bi-exclamation-diamond-fill","mx-2")),requestAnimationFrame(()=>{document.querySelectorAll(".variant-images").forEach((o,p)=>{new S(o,{perPage:1,arrows:!1,pagination:!0,drag:!1}).mount();const u=e[p];if(!u||!u.variants)return;const y=o.querySelectorAll(".splide__pagination__page");u.variants.forEach((d,v)=>{const f=y[v];if(!f||!d.colors)return;const L=d.colors.map(w=>d.colors.length>1?`${w} ${100/d.colors.length}%`:w).join(", ");f.style.cssText=`
                        --variant-base-color: ${d.colors[0]};
                        background-image: linear-gradient( -45deg, ${L} );
                        box-shadow: 0 0 0 0.125rem ${d.colors[0]};
                    `})})})}catch(r){console.log(r),c.insertAdjacentHTML("beforeend",k("Error Loading Products.","danger"))}finally{const r=document.getElementById("productCardSkeleton");r&&r.remove()}};let $=null,P=null;const x=(t,s)=>{t!=null&&t.splide&&t.splide.destroy(!0),s!=null&&s.splide&&s.splide.destroy(!0),P=new S(s,{fixedWidth:100,height:100,gap:12,pagination:!1,arrows:!1,isNavigation:!0}),$=new S(t,{pagination:!1,arrows:!1}),$.sync(P),$.mount(),P.mount()},Z=t=>{var c;const s=document.createElement("ul");return s.classList.add("varients","list-inline","d-flex","align-items-center","gap-3","mt-0"),(c=t.variants)==null||c.forEach(r=>{var l;const a=`
            <li class="mb-0">
                <button class="varient-button d-block rounded-circle transition-3" style="--variant-base-color: ${r.colors[0]};background-image: linear-gradient( -135deg, ${(l=r.colors)==null?void 0:l.map(e=>r.colors.length>1?`${e} ${100/r.colors.length}%`:`${e}`).join(", ")} );box-shadow: 0 0 0 0.125rem ${r.colors[0]};" data-varient-id="${r.id}"></button>
            </li>
        `;s.insertAdjacentHTML("beforeend",a)}),s},ee=(t,s,c,r=10)=>{const a=r===0?0:1,l=()=>{let n=parseInt(t.value)||1;(isNaN(n)||n<a)&&(n=a),n>r&&(n=r),t.value=n,e(n)},e=n=>{s.disabled=n>=r,c.disabled=n<=a};t.addEventListener("input",()=>t.value=t.value.replace(/[^0-9]/g,"")),t.addEventListener("blur",l),t.addEventListener("change",()=>{let n=parseInt(t.value)||a;e(n)}),s.addEventListener("click",n=>{n.preventDefault();let o=parseInt(t.value)||a;o<r&&o++,t.value=o,e(o)}),c.addEventListener("click",n=>{n.preventDefault();let o=parseInt(t.value)||a;o>a&&o--,t.value=o,e(o)}),l()},T=document.getElementById("productCategory"),B=document.querySelector("#productImageWrapper .splide__list"),M=document.querySelector(".product-variant-slider"),N=document.querySelector(".product-variant-thumbnail-slider"),A=document.querySelector(".product-variant-thumbnail-slider .splide__list"),H=document.getElementById("productName"),D=document.getElementById("productShortDescription"),j=document.getElementById("productRating"),_=document.getElementById("variantsContainer"),R=document.getElementById("productDetailedDescription"),Q=document.getElementById("selectedProductName"),b=document.getElementById("selectedProductImg"),I=document.getElementById("selectedProductColor"),E=document.getElementById("selectedProductQuantity"),m=document.querySelector("#quantity #quantityInput"),q=document.querySelector("#quantity #plus"),C=document.querySelector("#quantity #minus"),g=document.getElementById("stock"),h=document.getElementById("totalPrice"),F=document.getElementById("buyNow"),te=document.getElementById("relatedProducts"),ne=async()=>{var r;const t=new URLSearchParams(window.location.search),s=t.get("id");t.get("variantId");let c=parseInt(m.value)||1;try{const a=U(V,"collections","products","items",s),l=await G(a);if(l.exists()){const e=l.data();let n=e.variants[0].id;document.title=`Product | ${e.name}`,T&&(T.textContent=e.category),H&&(H.textContent=e.name),D&&(D.textContent=e.shortDescription),j&&(j.textContent=`${e.rating} Ratings`),_&&_.append(Z(e));const o=document.querySelectorAll(".varient-button");if(e.variants.length>0&&e.variants[0].images.length>0){const i=(r=e.variants[0].images)==null?void 0:r.map(u=>`
                    <li class="splide__slide mb-0">
                        <img src="${u}" alt="${e.name}" class="d-block img-fluid mx-auto" />
                    </li>
                `).join("");B.innerHTML=i,A.innerHTML=i}requestAnimationFrame(()=>x(M,N)),o.length>0&&o[0].classList.add("active"),o==null||o.forEach(i=>{i.addEventListener("click",()=>{var y;o.forEach(d=>d.classList.remove("active")),i.classList.add("active");const u=i.getAttribute("data-varient-id");n!==u&&(n=u,(y=e.variants)==null||y.forEach(d=>{var v;if(d.id===u){const f=(v=d.images)==null?void 0:v.map(L=>`<li class="splide__slide mb-0"><img src="${L}" alt="${e.name}" class="d-block img-fluid mx-auto" /></li>`).join("");B.innerHTML=f,A.innerHTML=f,requestAnimationFrame(()=>x(M,N)),b&&(b.innerHTML=`<img src="${d.images[0]}" alt="${e.name}" class="d-block img-fluid mx-auto" /> `),I&&(I.innerHTML=`<span class="current-variant-color d-block rounded-circle" style="background-color: ${d.colors[0]};"></span>`)}}))})}),R&&R.insertAdjacentHTML("beforeend",`
                <p>${e.detailedDescription}</p>
                <ul class="list-inline">
                    ${Object.keys(e.specifications).map(i=>`
                            <li class="d-flex align-items-center gap-2">
                                <span class="d-block">${i}: </span>
                                <span class="d-block fw-semibold">${e.specifications[i]}</span>
                            </li>
                        `).join("")}
                </ul>
            `),e.variants.forEach(i=>{i.id===n&&(b&&(b.innerHTML=`<img src="${i.images[0]}" alt="${e.name}" class="d-block img-fluid mx-auto" /> `),I&&(I.innerHTML=`<span class="current-variant-color d-block rounded-circle" style="background-color: ${i.colors[0]};"></span>`))}),Q&&(Q.textContent=e.name),E&&(E.textContent=c),ee(m,q,C,e.inStock),e.inStock===0&&(m.value=0,m.disabled=!0,q.disabled=!0,C.disabled=!0,g&&(g.textContent="Out of Stock"));const p=()=>{if(c=parseInt(m.value)||0,c>e.inStock&&(c=e.inStock,m.value=c),e.inStock===0){h&&(h.textContent="₹ 0.00"),g&&(g.textContent="Out of Stock");return}h&&(h.textContent=`₹ ${parseInt(e.price.current)*c}.00`),g&&(g.textContent=e.inStock-c),E&&(E.textContent=c)};p(),m.addEventListener("input",p),m.addEventListener("blur",p),m.addEventListener("change",p),q.addEventListener("click",p),C.addEventListener("click",p),F&&F.addEventListener("click",()=>{sessionStorage.setItem("buyNowItem",JSON.stringify({productId:s,productVariant:n,productQuantity:c})),window.location.href="./checkout.html"}),Y(e.id,e.category,te)}else console.log("No such Product Found!")}catch(a){console.log(a)}};ne();

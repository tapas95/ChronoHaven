import{b as A,d as L,e as N,u as j,a as e,E as M,r as H,t as T}from"./alert-DMWuZ5g4.js";import{g as B,h as I}from"./header-_iNkTwr9.js";import"./sidebar-DJcGTkuu.js";import{t as y}from"./togglePasswordVisibility-DyESKLue.js";const c=document.getElementById("firstName"),u=document.getElementById("lastName"),a=document.getElementById("email"),n=document.getElementById("phone"),p=document.querySelectorAll('input[name="gender"]'),m=document.getElementById("dob"),g=document.getElementById("saveProfile"),o=document.getElementById("updatePasswordForm"),P=document.getElementById("oldPassword"),i=document.getElementById("newPassword"),l=document.getElementById("confirmNewPassword"),b=document.getElementById("updatePasswordBtn");y("oldPasswordVisibility","oldPassword");y("newPasswordVisibility","newPassword");y("confirmNewPasswordVisibility","confirmNewPassword");function D(){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,s=/^[0-9]{10}$/,f=[...p].find(r=>r.checked);return document.querySelectorAll(".alert").forEach(r=>r.remove()),c&&!c.value.trim()?c.insertAdjacentHTML("afterend",e("Please enter your First Name")):u&&!u.value.trim()?u.insertAdjacentHTML("afterend",e("Please enter your Last Name")):a&&!a.value.trim()?a.insertAdjacentHTML("afterend",e("Please enter your Email")):a&&!t.test(a.value.trim())?a.insertAdjacentHTML("afterend",e("Invalid Email Address")):n&&!n.value.trim()?n.insertAdjacentHTML("afterend",e("Please enter your Mobile Number")):n&&!s.test(n.value.trim())?n.insertAdjacentHTML("afterend",e("Phone number must be 10 digits")):f?m&&!m.value.trim()?m.insertAdjacentHTML("afterend",e("Please enter your Date of Birth")):{firstName:c.value.trim(),lastName:u.value.trim(),email:a.value.trim(),phone:n.value.trim(),gender:f.value.trim(),dob:m.value.trim()}:p[0].closest(".gender-group").insertAdjacentHTML("beforeend",e("Please Select Your Gender"))}function S(){return document.querySelectorAll(".alert").forEach(t=>t.remove()),P&&!P.value.trim()?P.parentElement.insertAdjacentHTML("afterend",e("Please Enter Your Old Password")):i&&!i.value.trim()?i.parentElement.insertAdjacentHTML("afterend",e("Please Enter New Password")):P.value.trim()===i.value.trim()?i.parentElement.insertAdjacentHTML("afterend",e("Old Password and New Password Should Not be Same")):l&&!l.value.trim()?l.parentElement.insertAdjacentHTML("afterend",e("Please Enter Your New Password Again")):i.value.trim()!==l.value.trim()?l.parentElement.insertAdjacentHTML("afterend",e("Your New PassWord and Confirm Password Should be Same")):{oldPassword:P.value.trim(),newPassword:i.value.trim(),confirmNewPassword:l.value.trim()}}const k=async()=>{const t=await B();if(t){t.providerData.some(s=>s.providerId==="google.com")&&(document.getElementById("change-password-tab").remove(),document.getElementById("change-password-tab-pane").remove());try{const s=A(L,"users",t.uid),f=await N(s);if(f.exists()){const r=f.data(),h=[...p].find(w=>w.value===r.gender);c&&(c.value=r.firstName||""),u&&(u.value=r.lastName||""),a&&(a.value=r.email||""),n&&(n.value=r.phone||""),h&&(h.checked=!0),m&&(m.value=r.dob||""),g&&g.addEventListener("click",async w=>{w.preventDefault();const d=D();if(g.disabled=!0,!(!d||typeof d!="object"))try{await j(s,{...d}),g.insertAdjacentHTML("beforebegin",e("Profile information updated successfully!","success"))}catch(E){console.log(E)}finally{g.disabled=!1}}),o&&o.addEventListener("submit",async w=>{w.preventDefault();const d=S();if(d){const E=M.credential(t.email,d.oldPassword);try{b&&(b.disabled=!0),await H(t,E),await T(t,d.newPassword),o.insertAdjacentHTML("beforebegin",e("Password updated successfully!","success","mb-4")),await I()}catch(v){console.log(v),v.code==="auth/weak-password"?o.insertAdjacentHTML("beforebegin",e("Password should be at least 6 characters.","danger","mb-4")):v.code==="auth/invalid-credential"?o.insertAdjacentHTML("beforebegin",e("Old password is incorrect.","danger","mb-4")):o.insertAdjacentHTML("beforebegin",e(`Something went wrong: ${v.message}`,"danger","mb-4"))}finally{b&&(b.disabled=!1),o.reset()}}})}}catch(s){console.log(s)}}};k();
